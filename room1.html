<html>
<head>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component@1.3.1/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-cursor-teleport@1.5.0/dist/aframe-cursor-teleport-component.min.js"></script>
  <link rel="stylesheet" type="text/css" href="indexStyles.css">
  <!-- <script src="../scripts/script.js"></script> -->
  <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script>

</head>



<body >
  <a-scene 
  device-orientation-permission-ui="enabled: false"
  cursor="rayOrigin: mouse"
  raycaster="objects: [data-clickable]"
  animation-timeline__1="timeline: #myTimeline; loop:true"
  >
    <a-assets>
    <a-asset-item id="scene-glb" src="./Models/room.glb"></a-asset-item>
    <a-asset-item id="strength" src="./Models/strength.glb"></a-asset-item>
    <a-asset-item id="chair" src="./Models/chair.glb"></a-asset-item>
    <a-asset-item id="desktop" src="./Models/desktop.glb"></a-asset-item>
    <a-asset-item id="step" src="./Models/step.glb"></a-asset-item>
    <a-asset-item id="human" src="./Models/hand.glb"></a-asset-item>
      <img id="welcome" src="./Images/Welcome.png">
      <img id="task" src="./Images/task.png">
      <video id="videoBunny" preload="auto" src="https://cdn.aframe.io/videos/bunny.mp4" width="160" height="90" autoplay loop="true" crossOrigin="anonymous" muted></video>

    </a-assets>

    <a-entity id="cameraRig" cursor-teleport="cameraRig: #cameraRig; cameraHead: #head; ignoreEntities: .clickable" effect-manager>
      <a-entity id="head" position="0 2 0" camera look-controls="reverseMouseDrag: true" wasd-controls="acceleration:30" proximity-effect="target: #ring-strength; threshold: 1.5">
        <a-cylinder id="effects" position="0.7 0 0" height="3" radius="2" color=#000000"
                        material="opacity: 0.7; side: double;" visible="false"></a-cylinder>

      </a-entity>

    </a-entity>



    <a-entity gltf-model="#scene-glb" scale="0.8 0.8 0.8" position="-2 -0.39 4"></a-entity>
    <a-entity gltf-model="#strength" scale="0.6 0.6 0.6" position="-1.94 -0.28 4" rotation="0 0 0" id="#newId"></a-entity>
    <a-entity gltf-model="#step" scale="0.6 0.6 0.6" position="-2 -0.28 1.3 "></a-entity>

    <a-entity gltf-model="#chair" scale="0.6 0.6 0.6" position="-2 -0.28 4"></a-entity>
    <a-entity gltf-model="#desktop" scale="0.6 0.6 0.6" position="-2 -0.28 1"></a-entity>


    <!-- <a-entity environment="preset: default"></a-entity> -->
    <a-ring id="ring-strength"  color="teal" radius-inner="0.3" radius-outer="0.35" 
    position="5.9 0.011 -1.05" rotation="-90 0 0" teleport-and-play></a-ring>

    <a-entity gltf-model="#human" scale="0.2 0.2 0.2" position="4.5 1.4 -1" rotation="0 90 0" animation__yoyo="property: position; dir: alternate; dur: 1000;
    easing: easeInSine; loop: true; to: 5 1.4 -1"></a-entity>


    <a-image src="#task" class="clickable" id="img1" position="0 2 0"  data-clickable scale="1.8 0.7 0.7"
    visible="true"
    onclick="dosomething()"
    event-set__enter="_event: mouseenter;  width: 0.53; height: 0.53;"
    event-set__leave="_event: mouseleave;  width: 0.5; height: 0.5;"
    >
      
    </a-entity>



</a-entity>
</a-entity>
  </a-scene>




    <div class="nav-container">
      <input type="checkbox" id="toggle" checked />
      <label class="button" for="toggle">
        <nav class="nav">
          <ul>
            <li><a href="./index.html"><img src="Images/home.png" width="50%"></a></li>
            <li><a href="./room1.html"><img src="Images/room.png" width="40%"></a></li>
            <li><a href="#0"><img src="Images/audio.png" width="40%"></a></li>
          </ul>
        </nav>
      </label>
    </div>




    <script>
      function closePanel(panelId) {
          document.getElementById(panelId).style.display = "none";
      }
  
      function openPanel(panelId) {
          document.getElementById(panelId).style.display = "flex";
      }

      AFRAME.registerComponent('proximity-effect',{
        schema:{
          target:{type:'selector'},
          threshold:{type:'number',default:1}
        },
        init:function(){
          this.target=this.data.target;
          this.threshold=this.data.threshold;
          this.effectActive=false;
        },
        tick:function(){
          var cameraRigPosition = this.el.object3D.position;
          var targetPosition = this.target.object3D.position;

          var distanceXZ = Math.sqrt(Math.pow(cameraRigPosition.x - targetPosition.x, 2) + Math.pow(cameraRigPosition.z - targetPosition.z, 2));

          //check if within threshold 
          if(distanceXZ <=this.threshold && !this.effectActive){
            this.effectActive = true;
            this.el.querySelector('#effects').setAttribute('visible',true);
            console.log("entered");
          }
          else if(distanceXZ > this.threshold && this.effectActive){
            this.effectActive = false;
            this.el.querySelector('#effects').setAttribute('visible',false);
          }
        }

      });

      
     function dosomething(){
        document.querySelector('#img1').setAttribute('visible', false);        
        console.log("clicked");
      };

      </script>
</body>



</html>

